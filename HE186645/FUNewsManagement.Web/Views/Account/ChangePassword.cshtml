@{
    ViewData["Title"] = "Change Password";
}

<style>
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #f8f9fa;
    }

    .password-container {
        padding: 80px 0 100px;
    }

    .password-card {
        border: none;
        border-radius: 1.5rem;
        overflow: hidden;
        box-shadow: 0 15px 50px rgba(0,0,0,0.3);
        background: white;
        color: #2c3e50;
    }

    .card-header {
        background: linear-gradient(90deg, #667eea, #764ba2);
        color: white;
        padding: 1.5rem 2rem;
        border-bottom: none;
    }

        .card-header h4 {
            font-weight: 700;
            margin: 0;
        }

    .form-label {
        font-weight: 600;
        color: #34495e;
    }

    .form-control {
        border: 1px solid #ced4da;
        border-radius: 0.75rem;
        padding: 0.75rem 1rem;
        transition: all 0.3s;
    }

        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.25rem rgba(102, 126, 234, 0.25);
            outline: none;
        }

    .input-group-text {
        background: #f8f9fa;
        border: 1px solid #ced4da;
        border-right: none;
        border-radius: 0.75rem 0 0 0.75rem;
    }

    .password-toggle {
        cursor: pointer;
        background: transparent;
        border: none;
        padding: 0 1rem;
    }

    .btn-change {
        background: linear-gradient(90deg, #f39c12, #e67e22);
        border: none;
        color: white;
        transition: all 0.3s;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
    }

        .btn-change:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(243, 156, 18, 0.4);
        }

    .btn-cancel {
        background: linear-gradient(90deg, #6c757d, #5a6268);
        border: none;
        color: white;
        transition: all 0.3s;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
    }

        .btn-cancel:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(108, 117, 125, 0.4);
        }

    .page-title {
        color: white;
        text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }

    .error-message {
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.25rem;
    }
</style>

<div class="password-container">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">
            <div class="text-center mb-5">
                <h2 class="page-title display-5 fw-bold">
                    <i class="fas fa-key me-3"></i>Đổi Mật Khẩu
                </h2>
                <hr class="w-50 mx-auto border-light opacity-75" />
            </div>

            <div class="password-card">
                <div class="card-header">
                    <h4><i class="fas fa-key me-2"></i>Thay đổi mật khẩu</h4>
                </div>

                <div class="card-body p-5">
                    <form asp-action="ChangePassword" method="post" id="changePasswordForm">
                        @Html.AntiForgeryToken()

                        <div class="mb-4 position-relative">
                            <label for="oldPassword" class="form-label">Mật khẩu hiện tại</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                <input type="password" class="form-control pe-5" id="oldPassword" name="oldPassword" required />
                                <button type="button" class="password-toggle position-absolute top-50 end-0 translate-middle-y pe-3"
                                        onclick="togglePassword('oldPassword', 'oldEyeIcon')">
                                    <i class="fas fa-eye" id="oldEyeIcon"></i>
                                </button>
                            </div>
                        </div>

                        <div class="mb-4 position-relative">
                            <label for="newPassword" class="form-label">Mật khẩu mới</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                <input type="password" class="form-control pe-5" id="newPassword" name="newPassword" required minlength="6" />
                                <button type="button" class="password-toggle position-absolute top-50 end-0 translate-middle-y pe-3"
                                        onclick="togglePassword('newPassword', 'newEyeIcon')">
                                    <i class="fas fa-eye" id="newEyeIcon"></i>
                                </button>
                            </div>
                            <small class="text-muted d-block mt-1">Tối thiểu 6 ký tự</small>
                        </div>

                        <div class="mb-4 position-relative">
                            <label for="confirmPassword" class="form-label">Xác nhận mật khẩu mới</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                <input type="password" class="form-control pe-5" id="confirmPassword" name="confirmPassword" required />
                                <button type="button" class="password-toggle position-absolute top-50 end-0 translate-middle-y pe-3"
                                        onclick="togglePassword('confirmPassword', 'confirmEyeIcon')">
                                    <i class="fas fa-eye" id="confirmEyeIcon"></i>
                                </button>
                            </div>
                            <div id="confirmError" class="error-message" style="display:none;">
                                Mật khẩu xác nhận không khớp!
                            </div>
                        </div>

                        <hr class="my-4" />

                        <div class="d-flex gap-3 justify-content-end">
                            <button type="submit" class="btn btn-lg btn-change">
                                <i class="fas fa-save me-2"></i>Đổi mật khẩu
                            </button>
                            <a asp-action="Profile" class="btn btn-lg btn-cancel">
                                <i class="fas fa-times me-2"></i>Hủy bỏ
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function togglePassword(inputId, iconId) {
            const input = document.getElementById(inputId);
            const icon = document.getElementById(iconId);
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        document.getElementById('changePasswordForm').addEventListener('submit', function(e) {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const errorDiv = document.getElementById('confirmError');

            if (newPassword !== confirmPassword) {
                e.preventDefault();
                errorDiv.style.display = 'block';
            } else {
                errorDiv.style.display = 'none';
            }
        });
    </script>
}